<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>Content Manager</title>

    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- Admin Styles -->
    <link rel="stylesheet" href="/admin/admin.css">
  </head>
  <body>
    <!-- Load Decap CMS -->
    <script src="https://unpkg.com/decap-cms@^3.4.0/dist/decap-cms.js"></script>

    <!-- Add the debug widget code -->
    <script>
      const DebugControl = createClass({
        getDebugInfo() {
          const cms = window.CMS;
          return {
            methods: Object.keys(cms),
            backend: cms.getBackend(),
            collections: cms.getCollections ? cms.getCollections() : 'Not available',
            widgets: cms.getWidgets().map(w => ({
              name: w.name,
              control: w.controlComponent?.name,
              preview: w.previewComponent?.name
            })),
            locale: cms.getLocale(),
            mediaLibrary: cms.getMediaLibrary(),
            editorComponents: cms.getEditorComponents(),
            entry: this.props.entry?.toJS(),
            field: this.props.field?.toJS(),
            value: this.props.value
          };
        },

        render() {
          const debugInfo = this.getDebugInfo();
          console.log('Debug Info:', debugInfo);

          return h('pre', {}, JSON.stringify(debugInfo, null, 2));
        }
      });

      CMS.registerWidget('debug-widget', DebugControl);
    </script>
  </body>
</html>