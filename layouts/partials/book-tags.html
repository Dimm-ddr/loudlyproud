{{ define "book-tags" }}
  {{ $extraClasses := .extraClasses | default "" }}
  {{ $colors := site.Data.colors.colors }}
  {{ $tagMapping := site.Data.tag_mapping.tag_colors }}
  {{ $fallback := $colors.fallback }}

  <div class="flex flex-wrap gap-1 {{ $extraClasses }}">
    {{ range .tags }}
      {{ $tag := . }}
      {{ $normalizedTag := $tag | urlize }}
      {{ $colorKey := index $tagMapping $normalizedTag | default "fallback" }}
      {{ $tagStyle := index $colors $colorKey | default $fallback }}

      <button
        x-data
        :data-tag="{{ $tag | jsonify }}"
        @click="$store.tagManager.addTag($el.dataset.tag)"
        :class="{ 'bg-accent1 text-white': $store.tagManager.hasTag($el.dataset.tag) }"
        class="tag {{ $tagStyle.bg }} {{ $tagStyle.text }} hover:bg-accent1 hover:text-white transition-colors duration-200"
      >
        {{ $tag }}
      </button>
    {{ end }}
  </div>
{{ end }}